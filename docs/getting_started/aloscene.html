

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Aloscene: Computer vision with ease &mdash; Aloception 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Alodataset: Loading your vision datasets" href="alodataset.html" />
    <link rel="prev" title="Getting started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Aloception
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Geting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Aloscene: Computer vision with ease</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Hello-world">Hello world</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Exploring-Frames">Exploring Frames</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Normalizing-your-frame">Normalizing your frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Playing-with-dimensions">Playing with dimensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Playing-with-Frames">Playing with Frames</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="alodataset.html">Alodataset: Loading your vision datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="alonet.html">Alonet : Training your models</a></li>
<li class="toctree-l1"><a class="reference internal" href="augmented_tensor.html">About augmented tensors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Turorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/data_setup.html">How to setup your data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/training_detr.html">Training Detr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/finetuning_detr.html">Finetuning DETR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/training_panoptic.html">Training Panoptic Head module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/training_deformable_detr.html">Training Deformable DETR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/finetuning_deformable_detr.html">Finetuning Deformanble DETR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tensort_inference.html">Exporting DETR / Deformable-DETR to TensorRT</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Aloception API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aloscene/aloscene.html">Aloscene</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alodataset/alodataset.html">Alodataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alonet/alonet.html">Alonet</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Aloception</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Aloscene: Computer vision with ease</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/getting_started/aloscene.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Aloscene:-Computer-vision-with-ease">
<h1>Aloscene: Computer vision with ease<a class="headerlink" href="#Aloscene:-Computer-vision-with-ease" title="Permalink to this headline">¶</a></h1>
<p>Aloscene extends the use of tensors with Augmented Tensors and Spatial Augmented Tensors. The latter are designed to facilitate the use of computer vision data (such as frames, 2d boxes, 3d boxes, optical flow, disparity, camera parameters…).</p>
<div class="section" id="Hello-world">
<h2>Hello world<a class="headerlink" href="#Hello-world" title="Permalink to this headline">¶</a></h2>
<p>In the following, we simply use the CocoDetectionDataset to display one frame.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">get_view</span></code> method is specific to <strong>Augmented Tensor</strong>. It makes it easy for someone to display all the avaiable data within a <strong>Frame</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_view</span></code> return a <code class="docutils literal notranslate"><span class="pre">View</span></code> object that can be used to <code class="docutils literal notranslate"><span class="pre">render()</span></code> the frame using matplotlib or opencv.</p></li>
<li><p>By default, all labels within a frame will get their own view.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">alodataset</span> <span class="kn">import</span> <span class="n">CocoDetectionDataset</span>

<span class="n">coco_dataset</span> <span class="o">=</span> <span class="n">CocoDetectionDataset</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">coco_dataset</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">get_view</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_aloscene_2_0.png" src="../_images/getting_started_aloscene_2_0.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE</strong></p>
<p>We’re using the <code class="docutils literal notranslate"><span class="pre">sample</span></code>, therefore, you don’t need to have the CocoDataset installed on your machine. A small sample will be automatically downloaded for you.</p>
</div>
</div>
<div class="section" id="Exploring-Frames">
<h2>Exploring Frames<a class="headerlink" href="#Exploring-Frames" title="Permalink to this headline">¶</a></h2>
<p>Compared to simple Tensor, a Frame is a Tensor with additional properties. For instance, a Frame is a Tensor with a defined normalization (between 0 and 255 in the following example) and attached boxes of shape (2, 4)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tensor(
        normalization=255,
        boxes2d=torch.Size([2, 4])
        [[[153., 154., 152.,  ..., 207., 200., 127.],
         [179., 182., 186.,  ..., 238., 160., 124.],
         [236., 239., 240.,  ..., 246., 235., 240.],
         ...,
         [188., 185., 187.,  ..., 114., 119.,  84.],
         [187., 184., 186.,  ..., 147., 148., 133.],
         [192., 189., 192.,  ..., 126., 135., 138.]],

        [[142., 141., 139.,  ..., 214., 181.,  99.],
         [192., 195., 198.,  ..., 220., 152., 155.],
         [224., 227., 229.,  ..., 221., 240., 241.],
         ...,
         [193., 192., 194.,  ..., 126., 125., 110.],
         [191., 189., 195.,  ..., 163., 166., 164.],
         [197., 194., 197.,  ..., 141., 143., 153.]],

        [[124., 124., 120.,  ..., 198., 151.,   0.],
         [209., 212., 214.,  ..., 208., 163., 176.],
         [208., 211., 211.,  ..., 167., 243., 236.],
         ...,
         [196., 202., 204.,  ..., 124., 125., 107.],
         [203., 192., 192.,  ..., 176., 170., 167.],
         [203., 198., 200.,  ..., 138., 145., 148.]]])
</pre></div></div>
</div>
<div class="section" id="Normalizing-your-frame">
<h3>Normalizing your frame<a class="headerlink" href="#Normalizing-your-frame" title="Permalink to this headline">¶</a></h3>
<p>It is common in computer vision to require your frame to match a specific shape. Therefore, you can at any stage of your data pipeline make sure that the frame is in the right format.</p>
<p>In the following code <code class="docutils literal notranslate"><span class="pre">frame_01</span></code>will be converted with values between 0 and 1 based on the current frame normalization.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frame_01</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">norm01</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">frame_01</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;01&quot;</span>
</pre></div>
</div>
</div>
<p>Here is a quick overview of the other types of normalization available.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Between 0 and 255</span>
<span class="n">frame_255</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">norm255</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">frame_255</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;255&quot;</span>

 <span class="c1"># Great for resnet backbones</span>
<span class="n">frame_resnet</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">norm_resnet</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">frame_resnet</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;resnet&quot;</span>

<span class="c1"># A custom mean/std norm</span>
<span class="n">my_frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">mean_std_norm</span><span class="p">(</span>
    <span class="p">(</span><span class="mf">0.42</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.41</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_norm&quot;</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">my_frame</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;my_norm&quot;</span>

<span class="c1"># Between 0 and 1</span>
<span class="n">frame_01</span> <span class="o">=</span> <span class="n">my_frame</span><span class="o">.</span><span class="n">norm01</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">frame_01</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;01&quot;</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>NOTE</strong></p>
<p>No matter your normalization, you can still display your frame at any time with great color !</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_frame</span><span class="o">.</span><span class="n">get_view</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_aloscene_11_0.png" src="../_images/getting_started_aloscene_11_0.png" />
</div>
</div>
</div>
<div class="section" id="Playing-with-dimensions">
<h3>Playing with dimensions<a class="headerlink" href="#Playing-with-dimensions" title="Permalink to this headline">¶</a></h3>
<p>Frames and all augmented tensors rely on <code class="docutils literal notranslate"><span class="pre">names</span></code> to keep track of the dimension within the tensor.</p>
<p>In the following example we show the names, shape and types of the associated boxes labels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frame.names:&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frame.shape:&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type(boxes2d):&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">boxes2d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;boxes2d.shape:&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">boxes2d</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;boxes2d.shape:&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">boxes2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
frame.names: (&#39;C&#39;, &#39;H&#39;, &#39;W&#39;)
frame.shape: torch.Size([3, 422, 640])
type(boxes2d): &lt;class &#39;aloscene.bounding_boxes_2d.BoundingBoxes2D&#39;&gt;
boxes2d.shape: (&#39;N&#39;, None)
boxes2d.shape: torch.Size([2, 4])
</pre></div></div>
</div>
<p><strong>Adding one batch dimension to the frame, will therefore change the whole structure</strong>. The attached boxes will be converted into a list so that each frame of the batch can get associated with its own set of Boxes2D.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">frames</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">batch</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frame.names:&quot;</span><span class="p">,</span> <span class="n">frames</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frame.shape:&quot;</span><span class="p">,</span> <span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type(boxes2d):&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">boxes2d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(boxes2d)&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="o">.</span><span class="n">boxes2d</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
frame.names: (&#39;B&#39;, &#39;C&#39;, &#39;H&#39;, &#39;W&#39;)
frame.shape: torch.Size([1, 3, 422, 640])
type(boxes2d): &lt;class &#39;list&#39;&gt;
len(boxes2d) 1
</pre></div></div>
</div>
<div class="admonition warning">
<p class="admonition-title fa fa-exclamation-circle"><strong>WARNING</strong></p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">names</span></code> are experimental torch features. Thefore augmented Tensor are still experimental feature as well to use with caution.</p>
</div>
</div>
</div>
<div class="section" id="Playing-with-Frames">
<h2>Playing with Frames<a class="headerlink" href="#Playing-with-Frames" title="Permalink to this headline">¶</a></h2>
<p>Beyond having nice properties, Frames (and augmented tensors in general) can also benefit from consistent transformation across all labels. Let’s take the first example by cropping the Frame.</p>
<p>In the following example, the frame and all attached labels are automatically cropped accordingly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cropped_frame</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[:,</span><span class="mi">100</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span><span class="mi">200</span><span class="p">:</span><span class="mi">400</span><span class="p">]</span>
<span class="n">cropped_frame</span><span class="o">.</span><span class="n">get_view</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_aloscene_19_0.png" src="../_images/getting_started_aloscene_19_0.png" />
</div>
</div>
<p>Here is another example of flipping the frame horizontally.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flipped_frame</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">hflip</span><span class="p">()</span>
<span class="n">flipped_frame</span><span class="o">.</span><span class="n">get_view</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_aloscene_21_0.png" src="../_images/getting_started_aloscene_21_0.png" />
</div>
</div>
<p>Using what we’ve learned so far, we can know combine everything to create a new batch of frames with some augmentation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Apply some augmentation</span>
<span class="n">frame_1</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">hflip</span><span class="p">()[:,</span><span class="mi">100</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">200</span><span class="p">:</span><span class="mi">400</span><span class="p">]</span>
<span class="n">frame_2</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">hflip</span><span class="p">()[:,</span><span class="mi">200</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span><span class="mi">300</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>
<span class="n">frame_3</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[:,</span><span class="mi">100</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="mi">200</span><span class="p">:</span><span class="mi">400</span><span class="p">]</span>
<span class="n">frame_4</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[:,</span><span class="mi">200</span><span class="p">:</span><span class="mi">400</span><span class="p">,</span><span class="mi">300</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>

<span class="c1"># Batch all frames and concat everything</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span>
    <span class="n">frame_1</span><span class="o">.</span><span class="n">batch</span><span class="p">(),</span>
    <span class="n">frame_2</span><span class="o">.</span><span class="n">batch</span><span class="p">(),</span>
    <span class="n">frame_3</span><span class="o">.</span><span class="n">batch</span><span class="p">(),</span>
    <span class="n">frame_4</span><span class="o">.</span><span class="n">batch</span><span class="p">()</span>
<span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">frames</span><span class="o">.</span><span class="n">get_view</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/getting_started_aloscene_23_0.png" src="../_images/getting_started_aloscene_23_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="alodataset.html" class="btn btn-neutral float-right" title="Alodataset: Loading your vision datasets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Visual Behavior.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>